!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Ballpen=t()}(this,function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){return t={exports:{}},e(t,t.exports),t.exports}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function t(){e(this,t)}return o(t,null,[{key:"findReferenceNode",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=r;if(t.isObject(e))for(var o in e)(t.isObject(e[o])||t.isArray(e[o]))&&(i+=o+".",n.set(i.slice(0,-1),[]),t.findReferenceNode(e[o],n,i));else t.isArray(e)&&e.forEach(function(e,r){(t.isObject(e)||t.isArray(e))&&(i+=r+".",n.set(i.slice(0,-1),[]),t.findReferenceNode(e,n,i))});return n}},{key:"isHTMLCollection",value:function(e){return"[object HTMLCollection]"===Object.prototype.toString.call(e)}},{key:"isArray",value:function(e){return Array.isArray(e)||"[object Array]"===Object.prototype.toString.call(e)}},{key:"toArray",value:function(e){return Array.prototype.slice.call(e)}},{key:"isObject",value:function(e){return"[object Object]"===Object.prototype.toString.call(e)}},{key:"isReferenceType",value:function(e){return t.isObject(e)||t.isArray(e)}},{key:"renderObjectValueByPath",value:function(e,n,r){var i=n.split(".");if("undefined"==typeof t.parseData(n,e).data&&t.throwError('Find an invalid watcher path when initializing Ballpen.js -> "'+n+'"',"Please make sure the watcher path you set is exist and valid."),1===i.length)e[i[0]]=r;else for(var o=0;o<i.length-1;o++)e=e[i[o]],e||t.throwError('Find an invalid watcher path when initializing Ballpen.js -> "'+n+'"',"Please make sure the watcher path you set is exist and valid."),o===i.length-2&&(e[i[i.length-1]]=r)}},{key:"parseData",value:function(e,t){var n=e.split("."),r=t,i=[];return n.forEach(function(e,n){0===n?(r=t[e],i.push(e)):(r=r[e],i.push(e))}),{path:i,data:r}}},{key:"ignoreInnerDirectives",value:function(e,t,n){for(var r=arguments.length,i=Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];var a=this;t.forEach(function(t){t.test(e)&&n&&n.call.apply(n,[a].concat(i))}),/^@/gi.test(e)||n&&n.call.apply(n,[this].concat(i))}},{key:"clone",value:function(e){var n=void 0;if(null===e||"object"!==("undefined"==typeof e?"undefined":i(e)))return e;if(e instanceof Date)return n=new Date,n.setTime(e.getTime()),n;if(e instanceof Array){n=[];for(var r=0,o=e.length;r<o;r++)n[r]=t.clone(e[r]);return n}if(e instanceof Object){n={};for(var a in e)e.hasOwnProperty(a)&&(n[a]=t.clone(e[a]));return n}t.throwError("Internal error, unable to copy object, type is not supported.","Please contact the author to fix this issue.")}},{key:"wrapAbsPath",value:function(e,n){return(t.isArray(e)&&e.length>0?e.join(".")+".":e.toString().length>0?e.toString()+".":"")+(t.isArray(n)&&n.length>0?n.join("."):n.toString().length>0?n.toString():"")}},{key:"throwError",value:function(e,t){var n=new Error("[Ballpen Parser Error] \n\n [Message] \n\n - "+e+" \n\n [Description] \n\n - "+t+" \n");throw n.name="BallpenError",n}},{key:"randomSequence",value:function(e){for(var t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],n="",r=0;r<e;r++){var i=Math.ceil(35*Math.random());n+=t[i]}return n}}]),t}(),s="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},u=t(function(e,t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(r,i){"object"==n(t)&&"object"==n(e)?e.exports=i():"object"==n(t)?t.axios=i():r.axios=i()}(s,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){function r(e){var t=new a(e),n=o(a.prototype.request,t);return i.extend(n,a.prototype,t),i.extend(n,t),n}var i=n(2),o=n(3),a=n(4),s=n(5),u=r(s);u.Axios=a,u.create=function(e){return r(i.merge(s,e))},u.Cancel=n(22),u.CancelToken=n(23),u.isCancel=n(19),u.all=function(e){return Promise.all(e)},u.spread=n(24),e.exports=u,e.exports.default=u},function(e,t,r){function i(e){return"[object Array]"===x.call(e)}function o(e){return"[object ArrayBuffer]"===x.call(e)}function a(e){return"undefined"!=typeof FormData&&e instanceof FormData}function s(e){var t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function u(e){return"string"==typeof e}function c(e){return"number"==typeof e}function f(e){return"undefined"==typeof e}function l(e){return null!==e&&"object"==("undefined"==typeof e?"undefined":n(e))}function d(e){return"[object Date]"===x.call(e)}function p(e){return"[object File]"===x.call(e)}function h(e){return"[object Blob]"===x.call(e)}function v(e){return"[object Function]"===x.call(e)}function y(e){return l(e)&&v(e.pipe)}function b(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function m(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function g(){return"undefined"!=typeof window&&"undefined"!=typeof document&&"function"==typeof document.createElement}function w(e,t){if(null!==e&&"undefined"!=typeof e)if("object"==("undefined"==typeof e?"undefined":n(e))||i(e)||(e=[e]),i(e))for(var r=0,o=e.length;r<o;r++)t.call(null,e[r],r,e);else for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.call(null,e[a],a,e)}function A(){function e(e,r){"object"==n(t[r])&&"object"==("undefined"==typeof e?"undefined":n(e))?t[r]=A(t[r],e):t[r]=e}for(var t={},r=0,i=arguments.length;r<i;r++)w(arguments[r],e);return t}function E(e,t,n){return w(t,function(t,r){n&&"function"==typeof t?e[r]=P(t,n):e[r]=t}),e}var P=r(3),x=Object.prototype.toString;e.exports={isArray:i,isArrayBuffer:o,isFormData:a,isArrayBufferView:s,isString:u,isNumber:c,isObject:l,isUndefined:f,isDate:d,isFile:p,isBlob:h,isFunction:v,isStream:y,isURLSearchParams:b,isStandardBrowserEnv:g,forEach:w,merge:A,extend:E,trim:m}},function(e,t){e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){function r(e){this.defaults=e,this.interceptors={request:new a,response:new a}}var i=n(5),o=n(2),a=n(16),s=n(17),u=n(20),c=n(21);r.prototype.request=function(e){"string"==typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),e=o.merge(i,this.defaults,{method:"get"},e),e.baseURL&&!u(e.url)&&(e.url=c(e.baseURL,e.url));var t=[s,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},o.forEach(["delete","get","head"],function(e){r.prototype[e]=function(t,n){return this.request(o.merge(n||{},{method:e,url:t}))}}),o.forEach(["post","put","patch"],function(e){r.prototype[e]=function(t,n,r){return this.request(o.merge(r||{},{method:e,url:t,data:n}))}}),e.exports=r},function(e,t,n){function r(e,t){!o.isUndefined(e)&&o.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function i(){var e;return"undefined"!=typeof XMLHttpRequest?e=n(7):"undefined"!=typeof process&&(e=n(7)),e}var o=n(2),a=n(6),s=/^\)\]\}',?\n/,u={"Content-Type":"application/x-www-form-urlencoded"},c={adapter:i(),transformRequest:[function(e,t){return a(t,"Content-Type"),o.isFormData(e)||o.isArrayBuffer(e)||o.isStream(e)||o.isFile(e)||o.isBlob(e)?e:o.isArrayBufferView(e)?e.buffer:o.isURLSearchParams(e)?(r(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):o.isObject(e)?(r(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e){e=e.replace(s,"");try{e=JSON.parse(e)}catch(e){}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},o.forEach(["delete","get","head"],function(e){c.headers[e]={}}),o.forEach(["post","put","patch"],function(e){c.headers[e]=o.merge(u)}),e.exports=c},function(e,t,n){var r=n(2);e.exports=function(e,t){r.forEach(e,function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])})}},function(e,t,n){var r=n(2),i=n(8),o=n(11),a=n(12),s=n(13),u=n(9),c="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(14);e.exports=function(e){return new Promise(function(t,f){var l=e.data,d=e.headers;r.isFormData(l)&&delete d["Content-Type"];var p=new XMLHttpRequest,h="onreadystatechange",v=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in p||s(e.url)||(p=new window.XDomainRequest,h="onload",v=!0,p.onprogress=function(){},p.ontimeout=function(){}),e.auth){var y=e.auth.username||"",b=e.auth.password||"";d.Authorization="Basic "+c(y+":"+b)}if(p.open(e.method.toUpperCase(),o(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p[h]=function(){if(p&&(4===p.readyState||v)&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,r=e.responseType&&"text"!==e.responseType?p.response:p.responseText,o={data:r,status:1223===p.status?204:p.status,statusText:1223===p.status?"No Content":p.statusText,headers:n,config:e,request:p};i(t,f,o),p=null}},p.onerror=function(){f(u("Network Error",e)),p=null},p.ontimeout=function(){f(u("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED")),p=null},r.isStandardBrowserEnv()){var m=n(15),g=(e.withCredentials||s(e.url))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;g&&(d[e.xsrfHeaderName]=g)}if("setRequestHeader"in p&&r.forEach(d,function(e,t){"undefined"==typeof l&&"content-type"===t.toLowerCase()?delete d[t]:p.setRequestHeader(t,e)}),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(e){if("json"!==p.responseType)throw e}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){p&&(p.abort(),f(e),p=null)}),void 0===l&&(l=null),p.send(l)})}},function(e,t,n){var r=n(9);e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n)):e(n)}},function(e,t,n){var r=n(10);e.exports=function(e,t,n,i){var o=new Error(e);return r(o,t,n,i)}},function(e,t){e.exports=function(e,t,n,r){return e.config=t,n&&(e.code=n),e.response=r,e}},function(e,t,n){function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var i=n(2);e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(i.isURLSearchParams(t))o=t.toString();else{var a=[];i.forEach(t,function(e,t){null!==e&&"undefined"!=typeof e&&(i.isArray(e)&&(t+="[]"),i.isArray(e)||(e=[e]),i.forEach(e,function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),a.push(r(t)+"="+r(e))}))}),o=a.join("&")}return o&&(e+=(e.indexOf("?")===-1?"?":"&")+o),e}},function(e,t,n){var r=n(2);e.exports=function(e){var t,n,i,o={};return e?(r.forEach(e.split("\n"),function(e){i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t&&(o[t]=o[t]?o[t]+", "+n:n)}),o):o}},function(e,t,n){var r=n(2);e.exports=r.isStandardBrowserEnv()?function(){function e(e){var t=e;return n&&(i.setAttribute("href",t),t=i.href),i.setAttribute("href",t),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}var t,n=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");return t=e(window.location.href),function(n){var i=r.isString(n)?e(n):n;return i.protocol===t.protocol&&i.host===t.host}}():function(){return function(){return!0}}()},function(e,t){function n(){this.message="String contains an invalid character"}function r(e){for(var t,r,o=String(e),a="",s=0,u=i;o.charAt(0|s)||(u="=",s%1);a+=u.charAt(63&t>>8-s%1*8)){if(r=o.charCodeAt(s+=.75),r>255)throw new n;t=t<<8|r}return a}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=new Error,n.prototype.code=5,n.prototype.name="InvalidCharacterError",e.exports=r},function(e,t,n){var r=n(2);e.exports=r.isStandardBrowserEnv()?function(){return{write:function(e,t,n,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),a===!0&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(e,t,n){function r(){this.handlers=[]}var i=n(2);r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){i.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=r},function(e,t,n){function r(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var i=n(2),o=n(18),a=n(19),s=n(5);e.exports=function(e){r(e),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),i.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]});var t=e.adapter||s.adapter;return t(e).then(function(t){return r(e),t.data=o(t.data,t.headers,e.transformResponse),t},function(t){return a(t)||(r(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){var r=n(2);e.exports=function(e,t,n){return r.forEach(n,function(n){e=n(e,t)}),e}},function(e,t){e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t){e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t){e.exports=function(e,t){return e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,"")}},function(e,t){function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t,n){function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new i(e),t(n.reason))})}var i=n(22);r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e,t=new r(function(t){e=t});return{token:t,cancel:e}},e.exports=r},function(e,t){e.exports=function(e){return function(t){return e.apply(null,t)}}}])})}),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=function(){function e(){n(this,e)}return c(e,null,[{key:"set",value:function(t){t.registerPlugin=e.registerPlugin,t.$http=u,t.$refs={}}},{key:"registerPlugin",value:function(e,t){Ballpen["$"+e]=t}}]),e}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=function(){function e(t,n){var i=this;r(this,e),this.$dataModel=n,f.set(e),this.lifecycleHookPoint("beforeRender",this.$dataModel,function(){i.init(t,i.$dataModel),i.scan(i.$el)})}return l(e,[{key:"lifecycleHookPoint",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t.data;"beforeRender"===e&&t.lifecycle&&t.lifecycle.beforeRender?new Promise(function(e,r){return t.lifecycle.beforeRender.call(n,e,r,i)}).then(function(){r&&r.call(n,t)}).catch(function(e){}):"afterRender"===e&&t.lifecycle&&t.lifecycle.afterRender?t.lifecycle.afterRender.call(this,i):r&&r.call(this,t)}},{key:"init",value:function(e,t){var n=this;if(this.$el=document.querySelector(e),this.$el||a.throwError('Find an invalid root element when initializing Ballpen.js -> "'+e+'"','Well, you should set a valid root element for Ballpen.js first constructor parameter, eg: "#app", "#container".'),t.events&&(this.$eventList={},this.initEventList(t.events)),t.data&&(this.$dataListPure=t.data,this.data=this.$dataListPure,this.$dataList=a.clone(t.data)),t.watchers){this.watchersHook=a.findReferenceNode(this.$dataList);var r=t.watchers,i=function(e){var t={root:e,handler:r[e].handler};n.watchersHook.forEach(function(n,r){new RegExp("^"+e,"ig").test(r)&&n.push(t)})};for(var o in r)i(o);this.watchersHook.forEach(function(e,t){a.renderObjectValueByPath(n.$dataList,t,n.setProxy(t,e))})}this.$registers=[]}},{key:"setProxy",value:function(e,t){var n=this,r=a.parseData(e,this.$dataList).data,i=a.parseData(e,this.$dataListPure).data,o={get:function(e,n){return t.forEach(function(e){e.handler,e.root}),e[n]},set:function(r,o,s,u){if(s!==i[o]){var c=void 0;a.isReferenceType(s)?(i[o]=a.clone(s),c=a.clone(s)):(i[o]=s,c=s),a.renderObjectValueByPath(n.$dataListPure,e+"."+o,c),r[o]=s,t.forEach(function(e){var t=e.handler,r=e.root;t&&t.call(n,a.parseData(r,n.$dataListPure).data,a.parseData(r,n.$dataList).data)})}return!0},defineProperty:function(e,t,n){return Reflect.defineProperty(e,t,n)}};return new Proxy(r,o)}},{key:"initEventList",value:function(e){if(e){var t=e;for(var n in t)this.$eventList[n]={},this.$eventList[n].type="",this.$eventList[n].fn=t[n]}}},{key:"scan",value:function(e){for(var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=function(n){var r=e.children[n];if(r.hasAttributes()){for(var i=r.attributes,o=[],a=0;a<i.length;a++){var s=i.item(a);o.push(s.name),/bp-event/gi.test(s.name)&&!function(){r.removeAttribute(s.name);var e=[],n=s;if(/bp-event:/gi.test(n.name))e.push({_fnType:n.name.split(":")[1],_fnName:n.value});else{var i=n.value.match(/[a-zA-Z]+:[a-zA-Z0-9_$]+/gi);i.forEach(function(t){e.push({_fnType:t.split(":")[0],_fnName:t.split(":")[1]})})}e.forEach(function(e){var n=e._fnType,i=e._fnName;t.bindEvent(r,i,n,t.$dataList,{})})}(),/bp-bind/gi.test(s.name)&&!function(){r.removeAttribute(s.name);var e=[],n=s;if(/bp-bind:/gi.test(n.name))e.push({_bindKey:n.name.split(":")[1],_thisSubModelAbs:n.value});else{var i=n.value.match(/[a-zA-Z0-9_$-]+:[a-zA-Z0-9_$.]+/gi);i.forEach(function(t){e.push({_bindKey:t.split(":")[0],_thisSubModelAbs:t.split(":")[1]})})}e.forEach(function(e){var n=e._bindKey,i=e._thisSubModelAbs;t.bindBind(r,i,n)})}()}if(o.includes("bp-pre"))return t.bindPre(r),"continue";if(o.includes("bp-for"))return t.bindFor(r),"continue";o.includes("bp-model")&&t.bindModel(r),o.includes("bp-class")&&t.bindClass(r),o.includes("bp-show")&&t.bindShow(r),o.includes("bp-ref")&&t.bindRef(r)}var u=r.childNodes;u.forEach(function(e,n){e.nodeType===Node.TEXT_NODE&&t.bindMoustache(r,e)}),r.children.length>0&&t.scan(r,!1)},i=0;i<e.children.length;i++){r(i)}n&&(this.attach(),this.$el.removeAttribute("bp-shade"),this.lifecycleHookPoint("afterRender",this.$dataModel))}},{key:"bindRef",value:function(t){var n=t.getAttribute("bp-ref");a.isArray(e.$refs[n])?e.$refs[n].push(t):(e.$refs[n]=[],e.$refs[n].push(t)),t.removeAttribute("bp-ref")}},{key:"bindShow",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=a.wrapAbsPath(n,e.getAttribute("bp-show"));a.ignoreInnerDirectives(r,[],function(e){var n=a.parseData(r,t.$dataList),i=e.style;n.data?i.removeProperty?i.removeProperty("display"):i.removeAttribute("display"):i.display="none",t.register(t.$dataList,t.$dataListPure,n.path,function(e,t){t?i.removeProperty?i.removeProperty("display"):i.removeAttribute("display"):i.display="none"})},e),e.removeAttribute("bp-show")}},{key:"bindModel",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=a.wrapAbsPath(n,e.getAttribute("bp-model"));a.ignoreInnerDirectives(r,[/^@{([\d]+)}$/gi],function(e){if(/^@{([\d]+)}$/gi.test(r)){var n=r.match(/^@{([\d]+)}$/)[1];"INPUT"===e.tagName?e.value=n:e.innerText=n}else{var i=a.parseData(r,t.$dataList);"INPUT"===e.tagName?e.value=i.data:e.innerText=i.data,t.register(t.$dataList,t.$dataListPure,i.path,function(t,n){"INPUT"===e.tagName?e.value=n:e.innerText=n})}},e),e.removeAttribute("bp-model")}},{key:"bindMoustache",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=t.nodeValue,o=t.nodeValue,s=o.match(/{{.*?}}/gi),u={};if(a.isArray(s)&&s.length>0){s.forEach(function(e){var s=e.slice(2,-2).trim();/^@{([\d]+)}$/gi.test(s)?u[e]=s.match(/^@{([\d]+)}$/)[1]:!function(){var c=a.parseData(a.wrapAbsPath(r,s),n.$dataList);u[e]=c.data,n.register(n.$dataList,n.$dataListPure,c.path,function(e,n){u["{{ "+c.path.join(".")+" }}"]=n;for(var r in u)o=i.replace(r,u[r]);t.nodeValue=o})}()});for(var c in u)o=i.replace(c,u[c])}t.nodeValue=o}},{key:"bindClass",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=a.wrapAbsPath(n,e.getAttribute("bp-class"));a.ignoreInnerDirectives(r,[],function(e){var n=a.parseData(r,t.$dataList);e.classList.contains(n.data)||e.classList.add(n.data),t.register(t.$dataList,t.$dataListPure,n.path,function(t,n){e.classList.remove(t),e.classList.contains(n)||e.classList.add(n)})},e),e.removeAttribute("bp-class")}},{key:"bindPre",value:function(e){e.removeAttribute("bp-pre")}},{key:"bindEvent",value:function(e,t,n,r){var i=this,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};a.ignoreInnerDirectives(t,[],function(e,t,n,r){i.$eventList[t].type=n,e.addEventListener(n,function(){i.$eventList[t].fn.call(i.$dataList,e,r,o)})},e,t,n,r,o)}},{key:"bindBind",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];a.ignoreInnerDirectives(t,[],function(e,t,n){var o=a.wrapAbsPath(i,t),s=a.parseData(o,r.$dataList);e.setAttribute(n,s.data),r.register(r.$dataList,r.$dataListPure,s.path,function(t,r){e.setAttribute(n,r)})},e,t,n)}},{key:"bindFor",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=e.getAttribute("bp-for").split(/\s+in\s+/),o=i[1],s=i[0],u=a.randomSequence(12);if(/^@/gi.test(s)||a.throwError('Invalid alias name when initializing a "bp-for" condition -> "'+s+'".','Please make sure the alias name is start with a "@" symbol.'),/\./gi.test(o)){var c=o.split(".");n[o]=n[c[0]]+"."+c[1]}else n[o]=o;for(var f=a.clone(n),l=a.clone(r),d=a.parseData(n[o],this.$dataList),p=e.parentNode,h=document.createDocumentFragment(),v=0;v<d.data.length;v++){var y=e.cloneNode(!0),b=n[o]+"."+v;n[s]=b,r[s]=v,y.removeAttribute("bp-for"),y.setAttribute("bp-for-rendered-id",u),this.bindForItemsRecursion(y,n,r,b,v,!0,function(e){h.appendChild(e)})}p.replaceChild(h,e),this.register(this.$dataList,this.$dataListPure,d.path,function(n,r){for(var i=document.createDocumentFragment(),a=0;a<r.length;a++){var c=e.cloneNode(!0),d=f[o]+"."+a;f[s]=d,l[s]=a,c.removeAttribute("bp-for"),c.setAttribute("bp-for-rendered-id",u),t.bindForItemsRecursion(c,f,l,d,a,!0,function(e){i.appendChild(e)})}for(var h=p.querySelectorAll("[bp-for-rendered-id='"+u+"']"),v=0;v<h.length;v++)0===v?p.replaceChild(i,h.item(v)):h.item(v).remove()})}},{key:"bindForItemsRecursion",value:function(e,t,n,r,i){for(var o=this,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=!!a.isHTMLCollection(e),f=function(s){var u=c?e[s]:e,f=u.childNodes;if(f.forEach(function(e,r){e.nodeType===Node.TEXT_NODE&&!function(){var r=e.nodeValue,i=e.nodeValue,s=i.match(/{{.*?}}/gi),c={};if(a.isArray(s)&&s.length>0){s.forEach(function(e){var r=e.slice(2,-2).trim(),i=r;/^@/gi.test(r)&&(i=/\[\[index\]\]/gi.test(r)?"@{"+n[r.match(/^(.*)\[\[index\]\]$/)[1]]+"}":r.replace(/^@[a-z0-9A-Z_]*/,t[r.split(".")[0]])),c[e]="{{ "+i+" }}"});for(var f in c)i=r.replace(f,c[f])}e.nodeValue=i,o.bindMoustache(u,e)}()}),!u.hasAttributes()&&c)return u.children.length>0&&o.bindForItemsRecursion(u.children,t,n,r,i),"continue";for(var l=u.attributes,d=[],p=0;p<l.length;p++){var h=l.item(p);d.push(h.name),/bp-event/gi.test(h.name)&&!function(){var e=[];if(/bp-event:/gi.test(h.name))e.push({_fnType:h.name.split(":")[1],_fnName:h.value});else{var t=h.value.match(/[a-zA-Z]+:[a-zA-Z0-9_$]+/gi);t.forEach(function(t){e.push({_fnType:t.split(":")[0],_fnName:t.split(":")[1]})})}e.forEach(function(e){var t=e._fnType,n=e._fnName;/^@:/gi.test(n)?o.bindEvent(u,n.split(":")[1],t,o.$dataList,{index:i}):o.bindEvent(u,n,t,o.$dataList,{})})}(),/bp-bind/gi.test(h.name)&&!function(){var e=[];if(/bp-bind:/gi.test(h.name))e.push({_bindKey:h.name.split(":")[1],_thisSubModelAbs:h.value});else{var n=h.value.match(/[a-zA-Z0-9_$-]+:[a-zA-Z0-9_$.]+/gi);n.forEach(function(t){e.push({_bindKey:t.split(":")[0],_thisSubModelAbs:t.split(":")[1]})})}e.forEach(function(e){var n=e._bindKey,r=e._thisSubModelAbs;/^@/gi.test(r)&&(r=r.replace(/^@[a-z0-9A-Z_]*/,t[r.split(".")[0]])),o.bindBind(u,r,n)})}()}if(d.includes("bp-for"))return o.bindFor(u,t,n),"continue";if(d.includes("bp-ref")&&o.bindRef(u),d.includes("bp-class")){var v=u.getAttribute("bp-class"),y=v;/^@/gi.test(v)&&(y=v.replace(/^@[a-z0-9A-Z_]*/,t[v.split(".")[0]])),y!==v&&u.setAttribute("bp-class",y),o.bindClass(u)}if(d.includes("bp-model")){var b=u.getAttribute("bp-model"),m=b;/^@/gi.test(b)&&(m=/\[\[index\]\]/gi.test(b)?"@{"+n[b.match(/^(.*)\[\[index\]\]$/)[1]]+"}":/@{\d+}/gi.test(b)?b:b.replace(/^@[a-z0-9A-Z_]*/,t[b.split(".")[0]])),m!==b&&u.setAttribute("bp-model",m),o.bindModel(u)}if(d.includes("bp-show")){var g=u.getAttribute("bp-show"),w=g;/^@/gi.test(g)&&(w=g.replace(/^@[a-z0-9A-Z_]*/,t[g.split(".")[0]])),w!==g&&u.setAttribute("bp-show",w),o.bindShow(u)}u.children.length>0&&o.bindForItemsRecursion(u.children,t,n,r,i)},l=0;l<(c?e.length:1);l++){f(l)}s&&u&&u.call(this,e)}},{key:"observePath",value:function(e,t,n,r){var i=this;a.isArray(n)&&!function(){var o=e,a=void 0;n.forEach(function(e,t){/^\d+$/.test(e)&&(e=parseInt(e)),t<n.length-1?o=o[e]:a=e}),t=n.join("."),i.observeKey(o,t,a,r)}()}},{key:"observeKey",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];a.isArray(n)?this.observePath(e,t,n,i):!function(){var o=e[n],s=t;a.isObject(o)?(Object.defineProperty(e,n,{get:function(){return o},set:function(e){e!==o&&(i&&i.forEach(function(t){t.call(r,o,e)}),o=e,a.renderObjectValueByPath(r.$dataListPure,s,e))},enumerable:!0,configurable:!0}),Object.keys(o).forEach(function(e){r.observeKey(o,s+"."+e,e,i)})):a.isArray(o)?(Object.defineProperty(e,n,{get:function(){return o},set:function(e){e!==o&&(i&&i.forEach(function(t){t.call(r,o,e)}),o=e,a.renderObjectValueByPath(r.$dataListPure,s,e))},enumerable:!0,configurable:!0}),r.observeArray(o,s,i)):Object.defineProperty(e,n,{get:function(){return o},set:function(e){e!==o&&(i&&i.forEach(function(t){t.call(r,o,e)}),o=e,a.renderObjectValueByPath(r.$dataListPure,s,e))},enumerable:!0,configurable:!0})}()}},{key:"observeArray",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"],o=Array.prototype,s=Object.create(o),u=t;i.forEach(function(t){Object.defineProperty(s,t,{enumerable:!0,configurable:!0,writable:!0,value:function(){for(var i,s=arguments.length,c=Array(s),f=0;f<s;f++)c[f]=arguments[f];var l=e.slice(),d=(i=o[t]).call.apply(i,[e].concat(c)),p=e;return a.renderObjectValueByPath(n.$dataListPure,u,p),r&&r.forEach(function(e){e.call(n,l,p)}),d}})}),e.__proto__=s}},{key:"register",value:function e(t,n,r,i){var e=this.$registers.find(function(e){if(Object.is(e.obj,t)&&(e.key===r||e.key.toString()===r.toString()))return e});e?e.fns.push(i):this.$registers.push({obj:t,rootPath:[],key:r,fns:[i]})}},{key:"attach",value:function(){var e=this;this.$registers.forEach(function(t){e.observeKey(t.obj,t.rootPath,t.key,t.fns)})}}]),e}();return d});
//# sourceMappingURL=ballpen.min.js.map
