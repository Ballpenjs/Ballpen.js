!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Ballpen=e()}(this,function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var e=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),i=function(){function i(e,n){t(this,i),this.el=document.querySelector(e),this.dataModel=n,this.initOptions(n),this.scan(this.el)}return e(i,[{key:"initOptions",value:function(t){t.event&&(this.eventList={},this.initEventList(t.event)),t.data&&(this.dataList=t.data,this.modelList={}),this.registers=[]}},{key:"initEventList",value:function(t){if(t){var e=t;for(var i in e)this.eventList[i]={},this.eventList[i].type="",this.eventList[i].fn=e[i]}}},{key:"scan",value:function(t){for(var e=0;e<t.children.length;e++){var i=t.children[e];this.bind(i),i.children.length>0&&this.scan(i)}this.attach()}},{key:"bind",value:function(t){if(t.hasAttributes())for(var e=t.attributes,i=0;i<e.length;i++){var n=e.item(i);if("bp-model"===n.name&&this.bindModel(t),"bp-class"===n.name&&this.bindClass(t),/bp-event:/gi.test(n.name)){var r=n.name.split(":")[1],a=n.value;this.bindEvent(t,a,r)}"bp-for"===n.name&&this.bindFor(t)}}},{key:"bindModel",value:function(t){var e=t.getAttribute("bp-model"),n=i.parseData(e,this.dataList);"INPUT"===t.tagName?t.value=n.data:t.innerText=n.data,this.register(this.dataList,n.path,function(e,i){"INPUT"===t.tagName?t.value=i:t.innerText=i})}},{key:"bindClass",value:function(t){var e=t.getAttribute("bp-class"),n=i.parseData(e,this.dataList);t.classList.contains(n.data)||t.classList.add(n.data),this.register(this.dataList,n.path,function(e,i){t.classList.contains(i)||t.classList.add(i)})}},{key:"bindEvent",value:function(t,e,i){this.eventList[e].type=i,t.addEventListener(i,this.eventList[e].fn.bind(this.dataList))}},{key:"bindFor",value:function(t){for(var e=this,n=t.getAttribute("bp-for"),r=i.parseData(n,this.dataList),a=document.createDocumentFragment(),s=0;s<r.data.length;s++){var o=t.cloneNode(!0);o.removeAttribute("bp-for"),o.getAttribute("bp-class")&&this.bindClass(o),o.getAttribute("bp-event")&&this.bindEvent(o);var u=n+"."+s;a.appendChild(this.bindForItems(o,u))}t.parentNode.appendChild(a),t.remove(),this.register(this.dataList,r.path,function(i,r){for(var a=document.createDocumentFragment(),s=0;s<r.length;s++){var o=t.cloneNode(!0);o.getAttribute("bp-class")&&e.bindClass(o),o.getAttribute("bp-event")&&e.bindEvent(o);var u=n+"."+s;a.appendChild(e.bindForItems(o,u))}console.log(t),t.parentNode.appendChild(a),t.remove()})}},{key:"bindForItems",value:function(t,e){for(var i=0;i<t.children.length;i++){var n=t.children[i];if(n.getAttribute("bp-class")&&this.bindClass(n),n.getAttribute("bp-event")&&this.bindEvent(n),n.getAttribute("bp-for-item")){var r=n.getAttribute("bp-for-item"),a=e+("."+r);n.setAttribute("bp-model",a),n.removeAttribute("bp-for-item")}n.getAttribute("bp-model")&&this.bindModel(n),n.children.length>0&&this.bindForItems(n)}return t}},{key:"observePath",value:function(t,e,n){var r=this;i.isArray(e)&&!function(){var i=t,a=void 0;e.forEach(function(t,n){/^\d+$/.test(t)&&(t=parseInt(t)),n<e.length-1?i=i[t]:a=t}),r.observeKey(i,a,n)}()}},{key:"observeKey",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i.isArray(e)?this.observePath(t,e,r):!function(){var a=t[e];i.isObject(a)?Object.keys(a).forEach(function(t){n.observeKey(a,t,r)}):i.isArray(a)?n.observeArray(a,r):Object.defineProperty(t,e,{get:function(){return a},set:function(t){t!==a&&r&&r.forEach(function(e){e.call(n,a,t)}),a=t},enumerable:!0,configurable:!0})}()}},{key:"observeArray",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"],r=Array.prototype,a=Object.create(r);n.forEach(function(n){Object.defineProperty(a,n,{enumerable:!0,configurable:!0,writable:!0,value:function(){for(var a,s=arguments.length,o=Array(s),u=0;u<s;u++)o[u]=arguments[u];var c=t.slice(),l=(a=r[n]).call.apply(a,[t].concat(o));return i&&i.forEach(function(t){t.call(e,c,l)}),l}})}),t.__proto__=a,t.__proto__.__proto__===Array.prototype}},{key:"register",value:function t(e,i,n){var t=this.registers.find(function(t){if(Object.is(t.obj,e)&&(t.key===i||t.key.toString()===i.toString()))return t});t?t.fns.push(n):this.registers.push({obj:e,key:i,fns:[n]})}},{key:"attach",value:function(){var t=this;this.registers.forEach(function(e){t.observeKey(e.obj,e.key,e.fns)})}}],[{key:"isArray",value:function(t){return Array.isArray(t)||"[object Array]"===Object.prototype.toString.call(t)}},{key:"isObject",value:function(t){return"[object Object]"===Object.prototype.toString.call(t)}},{key:"parseData",value:function(t,e){var i=t.split("."),n=void 0,r=[];return i.forEach(function(t,i){0===i?(n=e[t],r.push(t)):(n=n[t],r.push(t))}),{path:r,data:n}}}]),i}();return i});
//# sourceMappingURL=ballpen.min.js.map
